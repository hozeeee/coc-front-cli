#! /usr/bin/env node

const program = require('commander');
const chalk = require('chalk');
const {
  setNpmRegistry
} = require("../src/npmUtils");


// npm config set registry=http://registry.npmjs.org
// npm config set registry=http://registry.npm.taobao.org
program
  .option("-s-r, --set-registry [type|url]", '设置全局 npm 镜像源\r\n    default: "http://registry.npmjs.org" \r\n    taobao: "http://registry.npm.taobao.org" ')
  .option("-g-r, --get-registry", "查看当前全局设置的 npm 镜像源")
  .parse(process.argv);


const argvFieldNames = ["setRegistry", "getRegistry"];
const argvMap = {}

for (let key of argvFieldNames) {
  typeof program[key] !== "undefined" ? (argvMap[key] = program[key]) : null
}

if (Object.values(argvMap).length > 1) {
  console.log(chalk.red("选项过多."));
  process.exit(1);
}

console.log(argvMap)

// if ([taobao, def, url].filter(i => i).length !== 1) {
//   console.log(chalk.red("无效参数."));
//   console.log(
//     "若想设置淘宝镜像，请执行 %s .",
//     chalk.yellow("fff-cli set-registry -t"),
//   );
//   process.exit(1);
// }

// if (taobao) url = "http://registry.npm.taobao.org";
// if (def) url = "http://registry.npmjs.org";

// setNpmRegistry(url);